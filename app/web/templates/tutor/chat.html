{% extends "base.html" %}
{% block content %}

<div class="card">
  <div class="flex items-center justify-between">
    <h2 class="text-xl font-semibold">Editor</h2>
    <div class="text-sm">
      <span id="auth_status" class="text-gray-600">Não autenticado</span>
      <a href="/tutor/doc/{{ doc.id }}" class="btn btn-ghost">Voltar</a>
    </div>
  </div>

<div class="card">
  <h2 class="text-xl font-semibold">Chat — {{ doc.title }}</h2>
  <form method="post" action="/tutor/doc/{{ doc.id }}/chat" class="flex gap-2 mb-3">
    <input class="input" name="question" placeholder="Pergunte sobre o conteúdo…" required/>
    <button class="btn btn-ghost">Perguntar</button>
  </form>
  <div class="space-y-2">
    {% for m in history %}
      {% if m.role == 'user' %}
        <div class="p-3 rounded bg-gray-100"><span class="text-xs text-gray-500">Você:</span> {{ m.message }}</div>
      {% else %}
        <div class="p-3 rounded bg-blue-50"><span class="text-xs text-gray-500">Assistente:</span> {{ m.message|safe }}</div>
      {% endif %}
    {% else %}
      <div class="text-sm text-gray-500">Sem mensagens ainda.</div>
    {% endfor %}
  </div>
</div>
{% endblock %}
